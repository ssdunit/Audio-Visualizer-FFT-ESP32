#define data 23
#define regclk 19
#define srclk 18
int Cathodes[8] = {13,14,21,22,25,26,27,32};
const uint8_t font[]{
//Capital Alphabets
  // A
  0x00,0x7E,0x09,0x09,0x09,0x7E,0x00,0x00,
  // B
  0x00,0x7F,0x49,0x49,0x49,0x36,0x00,0x00,
  // C
  0x00,0x3E,0x41,0x41,0x41,0x22,0x00,0x00,
  // D
  0x00,0x7F,0x41,0x41,0x22,0x1C,0x00,0x00,
  // E
  0x00,0x7F,0x49,0x49,0x49,0x41,0x00,0x00,
  // F
  0x00,0x7F,0x09,0x09,0x09,0x01,0x00,0x00,
  // G
  0x00,0x3E,0x41,0x49,0x49,0x7A,0x00,0x00,
  // H
  0x00,0x7F,0x08,0x08,0x08,0x7F,0x00,0x00,
  // I
  0x00,0x41,0x7F,0x41,0x00,0x00,0x00,0x00,
  // J
  0x00,0x20,0x40,0x41,0x3F,0x01,0x00,0x00,
  // K
  0x00,0x7F,0x08,0x14,0x22,0x41,0x00,0x00,
  // L
  0x00,0x7F,0x40,0x40,0x40,0x40,0x00,0x00,
  // M
  0x00,0x7F,0x02,0x0C,0x02,0x7F,0x00,0x00,
  // N
  0x00,0x7F,0x04,0x08,0x10,0x7F,0x00,0x00,
  // O
  0x00,0x3E,0x41,0x41,0x41,0x3E,0x00,0x00,
  // P
  0x00,0x7F,0x09,0x09,0x09,0x06,0x00,0x00,
  // Q
  0x00,0x3E,0x41,0x51,0x21,0x5E,0x00,0x00,
  // R
  0x00,0x7F,0x09,0x19,0x29,0x46,0x00,0x00,
  // S
  0x00,0x26,0x49,0x49,0x49,0x32,0x00,0x00,
  // T
  0x00,0x01,0x01,0x7F,0x01,0x01,0x00,0x00,
  // U
  0x00,0x3F,0x40,0x40,0x40,0x3F,0x00,0x00,
  // V
  0x00,0x1F,0x20,0x40,0x20,0x1F,0x00,0x00,
  // W
  0x00,0x7F,0x20,0x18,0x20,0x7F,0x00,0x00,
  // X
  0x00,0x63,0x14,0x08,0x14,0x63,0x00,0x00,
  // Y
  0x00,0x03,0x04,0x78,0x04,0x03,0x00,0x00,
  // Z
  0x00,0x61,0x51,0x49,0x45,0x43,0x00,0x00,

/*
    // --- Digit 0 (90 deg CCW) ---
    0x00, 0x3C, 0x42, 0x5E, 0x7E, 0x42, 0x3C, 0x00, 
    
    // --- Digit 1 (90 deg CCW) ---
    0x00, 0x00, 0x7E, 0x10, 0x10, 0x10, 0x00, 0x00, 
    
    // --- Digit 2 (90 deg CCW) ---
    0x00, 0x7C, 0x20, 0x10, 0x08, 0x06, 0x02, 0x7C, 
    
    // --- Digit 3 (90 deg CCW) ---
    0x00, 0x3C, 0x42, 0x02, 0x1C, 0x02, 0x42, 0x3C, 
    
    // --- Digit 4 (90 deg CCW) ---
    0x00, 0x00, 0x08, 0x10, 0x7E, 0x10, 0x08, 0x00, 
    
    // --- Digit 5 (90 deg CCW) ---
    0x00, 0x7C, 0x40, 0x7C, 0x02, 0x02, 0x42, 0x3C, 
    
    // --- Digit 6 (90 deg CCW) ---
    0x08,0x10,0x20,0x2e,0x32,0x14,0x08,0x00,
    
    // --- Digit 7 (90 deg CCW) ---
    0x00, 0x7E, 0x02, 0x04, 0x08, 0x10, 0x20, 0x20, 
    
    // --- Digit 8 (90 deg CCW) ---
    0x00, 0x3C, 0x42, 0x42, 0x3C, 0x42, 0x42, 0x3C, 
    
    // --- Digit 9 (90 deg CCW) ---
    0x00, 0x3C, 0x42, 0x42, 0x3E, 0x02, 0x04, 0x38
*/
};
uint8_t matrix[8]={
  0b00111100,
  0b01000010,
  0b10100101,
  0b10000001,
  0b10100101,
  0b10011001,
  0b01000010,
  0b00111100
};
/*const uint8_t st[] = {
  0b00111110,
  0b00001000,
  0b00001000,
  0b00111110,
  0b00000000,
  0b00100010,
  0b00100010,
  0b00111110,
  0b00100010,
  0b00100010,
  0b00000000,
  0b1
};*/
uint8_t st[64];
int length = 0;
void updatetext(const char *str, uint8_t *text, int *length){
  *length = 0;
  //*str points to string and loops till the pointer becomes NULL
  while(*str){
    //Checks if ASCII Value is greater than that of A and less that that of Z
    if(*str >= 'A' && *str <= 'Z'){
      int index_c = (*str - 'A') * 8; //index give the index of that particular character i.e. B has value of 66 A has 65 so B-A = 1 * 8 so its index is 8
      for(int i=0; i<8; i++){ // loops 8 times as the character has 8 bytes
        text[*length] = font[index_c+i]; //sets the length index of text as the value of idx+i
        (*length)++;
      }
    } 
    /*else if(*str>= '0' && *str<='9'){
      int index_n = 26*8 + (*str - '0') * 8;
      for(int i = 0;i<8; i++){
        text[*length] = font[index_n+i];
        (*length)++;
      }
    }*/
    str++;
  }

}
void setup()
{
  pinMode(data, OUTPUT);
  pinMode(regclk, OUTPUT);
  pinMode(srclk, OUTPUT);
  for(int i=0;i<8;i++){
  	pinMode(Cathodes[7-i],OUTPUT);
    digitalWrite(Cathodes[7-i], LOW);
  }
  for(int i=0;i<8;i++){
    matrix[i] = 0;
  }
  updatetext("Hello67",st,&length);
}

void loop()
{
  for(int i = 0;i<length;i++){
    shiftLeft(st[i]);
    for(int j = 0;j<50;j++){
      display();
    }
  }
  delayMicroseconds(800);
}
void display(){
 	for(int i=0;i<8;i++){
  for(int row=0;row<8;row++){
  	digitalWrite(Cathodes[7-row],LOW);
  }
  digitalWrite(regclk,LOW);
  shiftOut(data,srclk,LSBFIRST,~matrix[i]);
  digitalWrite(regclk,HIGH);
  digitalWrite(Cathodes[7-i],HIGH);
  delayMicroseconds(1000);
}
}
void shiftLeft(uint8_t column){
  for(int i=0;i<8;i++){
    matrix[i]<<=1;
    if(column&(1<<i)){
      matrix[i] |= 1;
    }
  }
}